import{c as m,d as h}from"./chunk-VO6XSAWB.js";import{signal as P,inject as _}from"@angular/core";import{RouterOutlet as O,RouterModule as y,Router as T}from"@angular/router";import{ActivatedRoute as k}from"@angular/router";import{CommonModule as v}from"@angular/common";import{FormsModule as w}from"@angular/forms";import*as e from"@angular/core";import*as c from"@angular/common";import*as d from"@angular/forms";import*as u from"@angular/material/input";import*as f from"@angular/material/select";import*as C from"@angular/material/checkbox";function S(r,i){if(r&1&&(e.\u0275\u0275elementStart(0,"mat-option",9),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"titlecase"),e.\u0275\u0275elementEnd()),r&2){let n=i.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,2,n))}}function D(r,i){if(r&1){let n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",10)(1,"mat-checkbox",11),e.\u0275\u0275listener("change",function(){let o=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.toggleFeature(o))}),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()}if(r&2){let n=i.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(),e.\u0275\u0275property("checked",a.features[n]),e.\u0275\u0275advance(),e.\u0275\u0275textInterpolate(n)}}var p=class r{constructor(i){this.tenant=i;let n=this.tenant.getCurrentTenant();this.currentPlan=n?.subscription?.plan??"enterprise",this.features=Object.assign({},n?.features||{})}plans=["free","basic","premium","enterprise"];currentPlan="enterprise";features={};setPlan(i){this.currentPlan=i,this.tenant.setPlan(i);let n=this.tenant.getCurrentTenant();this.features=Object.assign({},n?.features||{})}toggleFeature(i){this.features[i]=!this.features[i];let n={};n[i]=this.features[i],this.tenant.updateFeatures(n)}get keys(){return Object.keys(this.features||{})}static \u0275fac=function(n){return new(n||r)(e.\u0275\u0275directiveInject(h))};static \u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-tenant-switcher"]],decls:14,vars:4,consts:[[1,"tenant-switcher"],[1,"tenant-header"],[1,"tenant-name"],[1,"plan-select"],["appearance","outline"],["id","plan",3,"ngModelChange","selectionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"feature-list"],["class","feature",4,"ngFor","ngForOf"],[3,"value"],[1,"feature"],[3,"change","checked"]],template:function(n,a){if(n&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),e.\u0275\u0275text(3,"Tenant: "),e.\u0275\u0275elementStart(4,"strong"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),e.\u0275\u0275text(9,"Plan"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-select",5),e.\u0275\u0275twoWayListener("ngModelChange",function(s){return e.\u0275\u0275twoWayBindingSet(a.currentPlan,s)||(a.currentPlan=s),s}),e.\u0275\u0275listener("selectionChange",function(s){return a.setPlan(s.value)}),e.\u0275\u0275template(11,S,3,4,"mat-option",6),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(12,"div",7),e.\u0275\u0275template(13,D,3,2,"div",8),e.\u0275\u0275elementEnd()()),n&2){let o;e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(((o=a.tenant.getCurrentTenant())==null?null:o.displayName)||"Default"),e.\u0275\u0275advance(5),e.\u0275\u0275twoWayProperty("ngModel",a.currentPlan),e.\u0275\u0275advance(),e.\u0275\u0275property("ngForOf",a.plans),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",a.keys)}},dependencies:[v,c.NgForOf,w,d.NgControlStatus,d.NgModel,m,u.MatFormField,u.MatLabel,f.MatSelect,f.MatOption,C.MatCheckbox,c.TitleCasePipe],styles:[".tenant-switcher[_ngcontent-%COMP%]{padding:8px 12px;border-bottom:1px solid rgba(0,0,0,.06)}.tenant-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px}.tenant-name[_ngcontent-%COMP%]{font-size:13px}.plan-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:4px 6px;font-size:13px}.feature-list[_ngcontent-%COMP%]{margin-top:8px;display:flex;flex-wrap:wrap;gap:6px}.feature[_ngcontent-%COMP%]{font-size:12px;background:#00000008;padding:4px 6px;border-radius:4px}"]})};import*as t from"@angular/core";import*as b from"@angular/router";import*as M from"@angular/material/toolbar";import*as g from"@angular/material/list";import*as l from"@angular/material/sidenav";var x=class r{title=P("buildaq-schools");router=_(T);route=_(k);constructor(){}ngOnInit(){let i=new URLSearchParams(window.location.search),n=i.get("authToken");if(n){localStorage.setItem("shellAuthToken",n),localStorage.setItem("auth_token",n),window.parent!==window&&window.parent.postMessage({type:"schools-ready",token:n},"*");let o=new URL(window.location.href);o.searchParams.delete("authToken"),window.history.replaceState({},"",o.pathname+o.hash)}let a=i.get("goto");if(a)try{setTimeout(()=>{try{this.router.navigate([a])}catch(o){console.warn("goto navigation failed",o)}},50)}catch(o){console.warn("Failed to process goto query param",o)}}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["app-root"]],decls:26,vars:0,consts:[[1,"app-shell"],[1,"app-sidenav-container"],["mode","side","opened","",1,"app-sidebar"],["color","primary",1,"brand"],["mat-list-item","","routerLink","/dashboard"],["mat-list-item","","routerLink","/students"],["mat-list-item","","routerLink","/teachers"],["mat-list-item","","routerLink","/classes"],["mat-list-item","","routerLink","/attendance"],["mat-list-item","","routerLink","/fees"],["mat-list-item","","routerLink","/timetable"],["mat-list-item","","routerLink","/exams"],[1,"app-main"]],template:function(n,a){n&1&&(t.\u0275\u0275elementStart(0,"div",0)(1,"mat-sidenav-container",1)(2,"mat-sidenav",2)(3,"mat-toolbar",3),t.\u0275\u0275text(4,"BuildAQ Schools"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(5,"app-tenant-switcher"),t.\u0275\u0275elementStart(6,"mat-nav-list")(7,"a",4),t.\u0275\u0275text(8,"\u{1F3E0} Dashboard"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(9,"a",5),t.\u0275\u0275text(10,"\u{1F468}\u200D\u{1F393} Students"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"a",6),t.\u0275\u0275text(12,"\u{1F469}\u200D\u{1F3EB} Teachers"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(13,"a",7),t.\u0275\u0275text(14,"\u{1F3EB} Classes"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(15,"a",8),t.\u0275\u0275text(16,"\u{1F552} Attendance"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(17,"a",9),t.\u0275\u0275text(18,"\u{1F4B3} Fees"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(19,"a",10),t.\u0275\u0275text(20,"\u{1F4C5} Timetable"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"a",11),t.\u0275\u0275text(22,"\u{1F4DD} Exams"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(23,"mat-sidenav-content")(24,"main",12),t.\u0275\u0275element(25,"router-outlet"),t.\u0275\u0275elementEnd()()()())},dependencies:[O,y,b.RouterLink,p,m,M.MatToolbar,g.MatNavList,g.MatListItem,l.MatSidenav,l.MatSidenavContainer,l.MatSidenavContent],styles:[".app-shell[_ngcontent-%COMP%]{display:flex}.app-sidebar[_ngcontent-%COMP%]{width:220px;background:#1f2937;color:#fff;min-height:100vh;padding:1rem}.brand[_ngcontent-%COMP%]{font-weight:700;margin-bottom:1rem}.nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.nav-link[_ngcontent-%COMP%]{color:#d1d5db;text-decoration:none;padding:.5rem;border-radius:6px}.nav-link[_ngcontent-%COMP%]:hover{background:#ffffff0a;color:#fff}.app-main[_ngcontent-%COMP%]{flex:1;padding:1rem;background:#f3f4f6;min-height:100vh}.page[_ngcontent-%COMP%]{background:#fff;padding:1rem;border-radius:10px;box-shadow:0 4px 12px #0206170f}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid #eee;text-align:left}.class-card[_ngcontent-%COMP%]{background:#f8fafc;padding:.75rem;border-radius:8px;margin-bottom:.5rem}"]})};export{x as App};
